{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\kgrob\\\\Documents\\\\Proyectos de programaci\\xF3n\\\\OrgBoat\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\Users\\\\kgrob\\\\Documents\\\\Proyectos de programaci\\xF3n\\\\OrgBoat\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import socketIOClient from\"socket.io-client\";import{Users,PlusCircle,X,MoreHorizontal}from\"react-feather\";var ENDPOINT=\"http://localhost:5000\";function ChatSidebar(props,clicked){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),newChatMessage=_useState2[0],setNewChatMessage=_useState2[1];var chats;var my_uid;var last_message_message;chats=props.response.chats;my_uid=props.response.my_uid;function timeformat(date){var h=date.getHours();var m=date.getMinutes();var x=h>=12?\"PM\":\"AM\";h=h%12;h=h?h:12;m=m<10?\"0\"+m:m;var mytime=h+\":\"+m+\" \"+x;return mytime;}function getDateLabel(date){var dateLabelDate=date.getDate()<10?\"0\"+date.getDate():date.getDate();var dateLabelMonth=date.getMonth()+1<10?\"0\"+(date.getMonth()+1):date.getMonth()+1;var dateLabelYear=date.getFullYear();var dateLabel=dateLabelDate+\"/\"+dateLabelMonth+\"/\"+dateLabelYear;return dateLabel;}function ArchiveChat(chat_selected){var socket=socketIOClient(ENDPOINT);socket.emit(\"archived chat\",{chat:chat_selected});socket.on(\"archived response\",function(){socket.emit(\"get chats\");});}function profiledata(id){var socket=socketIOClient(ENDPOINT);socket.emit(\"ViewProfile\",{id:id});socket.on(\"retrieve viewprofile\",function(data){props.setuserProfile(data);});}function DeleteChat(idchat){var socket=socketIOClient(ENDPOINT);socket.emit(\"Delete Chat\",{chat_uid:idchat});socket.on(\"retrive delete chat\",function(){socket.emit(\"get chats\");});}var socket=socketIOClient(ENDPOINT);useEffect(function(){socket.on(\"chat message\",function(response){setNewChatMessage(function(chatMessages){return[response].concat(_toConsumableArray(chatMessages));});socket.emit(\"get chats\");});},[]);console.log(newChatMessage);return/*#__PURE__*/React.createElement(\"div\",{id:\"chats\",className:\"sidebar active\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"span\",null,\"Chats\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-inline\"},/*#__PURE__*/React.createElement(\"li\",{className:\"list-inline-item\",\"data-toggle\":\"tooltip\",title:\"New group\"},/*#__PURE__*/React.createElement(\"a\",{className:\"btn btn-outline-light\",href:\"#\",\"data-toggle\":\"modal\",\"data-target\":\"#newGroup\"},/*#__PURE__*/React.createElement(Users,null))),/*#__PURE__*/React.createElement(\"li\",{className:\"list-inline-item\"},/*#__PURE__*/React.createElement(\"a\",{className:\"btn btn-outline-light\",\"data-toggle\":\"tooltip\",title:\"New chat\",href:\"#\",\"data-navigation-target\":\"friends\"},/*#__PURE__*/React.createElement(PlusCircle,null))),/*#__PURE__*/React.createElement(\"li\",{className:\"list-inline-item d-xl-none d-inline\"},/*#__PURE__*/React.createElement(\"a\",{href:\"#\",className:\"btn btn-outline-light text-danger sidebar-close\"},/*#__PURE__*/React.createElement(X,null))))),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Search chats\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-body\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group list-group-flush\"},chats&&chats.map(function(chat){if(chat.chat_type==0&&chat.archiveChat==0&&chat.delete_chat==0){var chat_initial;var chat_name;var p;var chat_with_usr=chat.user_chat;if(my_uid!=chat.user_chat){chat_name=chat.name;chat_initial=chat_name.substring(0,1);var timeMessage=new Date(chat.last_message_time);var timeLabel;var today=new Date();var yesterday=new Date();yesterday.setDate(yesterday.getDate()-1);if(timeMessage.getDate()==today.getDate()&&timeMessage.getMonth()==today.getMonth()&&timeMessage.getFullYear()==today.getFullYear()){timeLabel=timeformat(timeMessage);}else if(timeMessage.getDate()==yesterday.getDate()&&timeMessage.getMonth()==yesterday.getMonth()&&timeMessage.getFullYear()==yesterday.getFullYear()){timeLabel=\"Yesterday\";}else{timeLabel=getDateLabel(timeMessage);}//var pphotoUser = new File([\"\"], chat.pphoto);\n//var p = \"\";\nif(chat.pphoto===\"\"){p=/*#__PURE__*/React.createElement(\"span\",{className:\"avatar-title bg-info rounded-circle\"},chat_initial);}else{p=/*#__PURE__*/React.createElement(\"img\",{src:chat.pphoto,className:\"rounded-circle\",alt:\"image\"});}return/*#__PURE__*/React.createElement(\"li\",{className:clicked.chat_uid===chat.chat_uid&&\"is-active\"?\"list-group-item chat-conversation-select chat-is-active\":\"list-group-item chat-conversation-select\",key:chat.chat_uid,i:chat.chat_uid,n:chat_name,t:timeMessage.getTime(),u:chat_with_usr,onClick:function onClick(){props.setClicked(chat);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"figure\",{className:\"avatar\"},p)),/*#__PURE__*/React.createElement(\"div\",{className:\"users-list-body\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h5\",{className:\"last-message-user\",i:chat.chat_uid},chat_name),/*#__PURE__*/React.createElement(\"p\",{className:\"last-message-chat\",i:chat.chat_uid},chat.last_message_message)),/*#__PURE__*/React.createElement(\"div\",{className:\"users-list-action\"},/*#__PURE__*/React.createElement(\"div\",{className:clicked.chat_uid===chat.chat_uid?\"new-message-count d-none\":\"new-message-count \",i:chat.chat_uid}),/*#__PURE__*/React.createElement(\"small\",{className:\"text-muted last-message-time\",i:chat.chat_uid},timeLabel),/*#__PURE__*/React.createElement(\"div\",{className:\"action-toggle\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown\"},/*#__PURE__*/React.createElement(\"a\",{\"data-toggle\":\"dropdown\",href:\"#\"},/*#__PURE__*/React.createElement(MoreHorizontal,null)),/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-menu dropdown-menu-right\"},/*#__PURE__*/React.createElement(\"a\",{href:\"#\",className:\"dropdown-item\"},\"Open\"),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return profiledata(chat.chat_uid);},\"data-navigation-target\":\"contact-information\",className:\"dropdown-item\"},\"Profile\"),/*#__PURE__*/React.createElement(\"a\",{href:\"#\",onClick:function onClick(){return ArchiveChat(chat.chat_uid);},className:\"dropdown-item\"},\"Add to archive\"),/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-divider\"}),/*#__PURE__*/React.createElement(\"a\",{href:\"#\",onClick:function onClick(){return DeleteChat(chat.chat_uid);},className:\"dropdown-item text-danger\"//   onclick=\"DeleteChat('${\n//   chat.chat_uid\n// }')\"\n},\"Delete\")))))));}else if(chat.chat_type==1){if(chat.user_chat==chat.last_message_user_uid){var _chat_name=chat.chat_name;var _chat_with_usr=chat.user_chat;var _chat_initial=_chat_name.substring(0,1);var _timeMessage=new Date(chat.last_message_time);var _timeLabel;var _today=new Date();var _yesterday=new Date();_yesterday.setDate(_yesterday.getDate()-1);if(_timeMessage.getDate()==_today.getDate()&&_timeMessage.getMonth()==_today.getMonth()&&_timeMessage.getFullYear()==_today.getFullYear()){_timeLabel=timeformat(_timeMessage);}else if(_timeMessage.getDate()==_yesterday.getDate()&&_timeMessage.getMonth()==_yesterday.getMonth()&&_timeMessage.getFullYear()==_yesterday.getFullYear()){_timeLabel=\"Ayer\";}else{_timeLabel=getDateLabel(_timeMessage);}return/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item chat-conversation-select\",key:chat.chat_uid,i:chat.chat_uid,n:_chat_name,t:_timeMessage.getTime(),u:_chat_with_usr,onClick:function onClick(){return console.log(\"holaaaa\");}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"figure\",{className:\"avatar\"},/*#__PURE__*/React.createElement(\"span\",{className:\"avatar-title bg-info rounded-circle\"},_chat_initial)),/*#__PURE__*/React.createElement(\"div\",{className:\"users-list-body\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h5\",{className:\"last-message-user\",i:chat.chat_uid},_chat_name),/*#__PURE__*/React.createElement(\"p\",{className:\"last-message-chat\",i:chat.chat_uid},chat.name,\": \",chat.last_message_message))),/*#__PURE__*/React.createElement(\"div\",{className:\"users-list-action\"},/*#__PURE__*/React.createElement(\"div\",{className:clicked.chat_uid===chat.chat_uid?\"new-message-count d-none\":\"new-message-count\",i:chat.chat_uid},/*#__PURE__*/React.createElement(\"small\",{className:\"text-muted last-message-time\",i:chat.chat_uid},_timeLabel),/*#__PURE__*/React.createElement(\"div\",{className:\"action-toggle\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown\"},/*#__PURE__*/React.createElement(\"a\",{\"data-toggle\":\"dropdown\",href:\"#\"},/*#__PURE__*/React.createElement(MoreHorizontal,null)),/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-menu dropdown-menu-right\"},/*#__PURE__*/React.createElement(\"a\",{href:\"#\",className:\"dropdown-item\"},\"Open\"),/*#__PURE__*/React.createElement(\"button\",{// onClick={profiledata({chat.chat_uid})}\n\"data-navigation-target\":\"contact-information\",className:\"dropdown-item\"},\"Profile\"),/*#__PURE__*/React.createElement(\"a\",{href:\"#\"// onClick=\"ArchiveChat('${chat.chat_uid}')\"\n,className:\"dropdown-item\"},\"Add to archive\"),/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-divider\"}),/*#__PURE__*/React.createElement(\"a\",{href:\"#\",className:\"dropdown-item text-danger\"},\"Delete\"))))))));}}}}))));}export default ChatSidebar;","map":{"version":3,"sources":["C:/Users/kgrob/Documents/Proyectos de programaciÃ³n/OrgBoat/src/components/ChatSidebar.js"],"names":["React","useState","useEffect","socketIOClient","Users","PlusCircle","X","MoreHorizontal","ENDPOINT","ChatSidebar","props","clicked","newChatMessage","setNewChatMessage","chats","my_uid","last_message_message","response","timeformat","date","h","getHours","m","getMinutes","x","mytime","getDateLabel","dateLabelDate","getDate","dateLabelMonth","getMonth","dateLabelYear","getFullYear","dateLabel","ArchiveChat","chat_selected","socket","emit","chat","on","profiledata","id","data","setuserProfile","DeleteChat","idchat","chat_uid","chatMessages","console","log","map","chat_type","archiveChat","delete_chat","chat_initial","chat_name","p","chat_with_usr","user_chat","name","substring","timeMessage","Date","last_message_time","timeLabel","today","yesterday","setDate","pphoto","getTime","setClicked","last_message_user_uid"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport socketIOClient from \"socket.io-client\";\r\nimport { Users, PlusCircle, X, MoreHorizontal } from \"react-feather\";\r\n\r\nconst ENDPOINT = \"http://localhost:5000\";\r\n\r\nfunction ChatSidebar(props, clicked) {\r\n  const [newChatMessage, setNewChatMessage] = useState([]);\r\n  let chats;\r\n  let my_uid;\r\n  let last_message_message;\r\n\r\n  chats = props.response.chats;\r\n  my_uid = props.response.my_uid;\r\n\r\n  function timeformat(date) {\r\n    var h = date.getHours();\r\n    var m = date.getMinutes();\r\n    var x = h >= 12 ? \"PM\" : \"AM\";\r\n    h = h % 12;\r\n    h = h ? h : 12;\r\n    m = m < 10 ? \"0\" + m : m;\r\n    var mytime = h + \":\" + m + \" \" + x;\r\n    return mytime;\r\n  }\r\n\r\n  function getDateLabel(date) {\r\n    let dateLabelDate =\r\n      date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate();\r\n    let dateLabelMonth =\r\n      date.getMonth() + 1 < 10\r\n        ? \"0\" + (date.getMonth() + 1)\r\n        : date.getMonth() + 1;\r\n    let dateLabelYear = date.getFullYear();\r\n    let dateLabel = dateLabelDate + \"/\" + dateLabelMonth + \"/\" + dateLabelYear;\r\n    return dateLabel;\r\n  }\r\n\r\n  function ArchiveChat(chat_selected) {\r\n    const socket = socketIOClient(ENDPOINT);\r\n    socket.emit(\"archived chat\", { chat: chat_selected });\r\n    socket.on(\"archived response\", function () {\r\n      socket.emit(\"get chats\");\r\n    });\r\n  }\r\n\r\n  function profiledata(id) {\r\n    const socket = socketIOClient(ENDPOINT);\r\n    socket.emit(\"ViewProfile\", { id: id });\r\n    socket.on(\"retrieve viewprofile\", function (data) {\r\n      props.setuserProfile(data);\r\n    });\r\n  }\r\n\r\n  function DeleteChat(idchat) {\r\n    const socket = socketIOClient(ENDPOINT);\r\n    socket.emit(\"Delete Chat\", { chat_uid: idchat });\r\n    socket.on(\"retrive delete chat\", () => {\r\n      socket.emit(\"get chats\");\r\n    });\r\n  }\r\n\r\n  const socket = socketIOClient(ENDPOINT);\r\n\r\n  useEffect(() => {\r\n    socket.on(\"chat message\", (response) => {\r\n      setNewChatMessage((chatMessages) => [response, ...chatMessages]);\r\n      socket.emit(\"get chats\");\r\n    });\r\n  }, []);\r\n\r\n  console.log(newChatMessage);\r\n\r\n  return (\r\n    <div id=\"chats\" className=\"sidebar active\">\r\n      <header>\r\n        <span>Chats</span>\r\n        <ul className=\"list-inline\">\r\n          <li\r\n            className=\"list-inline-item\"\r\n            data-toggle=\"tooltip\"\r\n            title=\"New group\"\r\n          >\r\n            <a\r\n              className=\"btn btn-outline-light\"\r\n              href=\"#\"\r\n              data-toggle=\"modal\"\r\n              data-target=\"#newGroup\"\r\n            >\r\n              <Users />\r\n            </a>\r\n          </li>\r\n          <li className=\"list-inline-item\">\r\n            <a\r\n              className=\"btn btn-outline-light\"\r\n              data-toggle=\"tooltip\"\r\n              title=\"New chat\"\r\n              href=\"#\"\r\n              data-navigation-target=\"friends\"\r\n            >\r\n              <PlusCircle />\r\n            </a>\r\n          </li>\r\n          <li className=\"list-inline-item d-xl-none d-inline\">\r\n            <a\r\n              href=\"#\"\r\n              className=\"btn btn-outline-light text-danger sidebar-close\"\r\n            >\r\n              <X />\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </header>\r\n      <form>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control\"\r\n          placeholder=\"Search chats\"\r\n        />\r\n      </form>\r\n      <div className=\"sidebar-body\">\r\n        <ul className=\"list-group list-group-flush\">\r\n          {chats &&\r\n            chats.map((chat) => {\r\n              if (\r\n                chat.chat_type == 0 &&\r\n                chat.archiveChat == 0 &&\r\n                chat.delete_chat == 0\r\n              ) {\r\n                let chat_initial;\r\n                let chat_name;\r\n                let p;\r\n                let chat_with_usr = chat.user_chat;\r\n                if (my_uid != chat.user_chat) {\r\n                  chat_name = chat.name;\r\n                  chat_initial = chat_name.substring(0, 1);\r\n                  let timeMessage = new Date(chat.last_message_time);\r\n                  let timeLabel;\r\n                  let today = new Date();\r\n                  let yesterday = new Date();\r\n                  yesterday.setDate(yesterday.getDate() - 1);\r\n                  if (\r\n                    timeMessage.getDate() == today.getDate() &&\r\n                    timeMessage.getMonth() == today.getMonth() &&\r\n                    timeMessage.getFullYear() == today.getFullYear()\r\n                  ) {\r\n                    timeLabel = timeformat(timeMessage);\r\n                  } else if (\r\n                    timeMessage.getDate() == yesterday.getDate() &&\r\n                    timeMessage.getMonth() == yesterday.getMonth() &&\r\n                    timeMessage.getFullYear() == yesterday.getFullYear()\r\n                  ) {\r\n                    timeLabel = \"Yesterday\";\r\n                  } else {\r\n                    timeLabel = getDateLabel(timeMessage);\r\n                  }\r\n                  //var pphotoUser = new File([\"\"], chat.pphoto);\r\n                  //var p = \"\";\r\n                  if (chat.pphoto === \"\") {\r\n                    p = (\r\n                      <span className=\"avatar-title bg-info rounded-circle\">\r\n                        {chat_initial}\r\n                      </span>\r\n                    );\r\n                  } else {\r\n                    p = (\r\n                      <img\r\n                        src={chat.pphoto}\r\n                        className=\"rounded-circle\"\r\n                        alt=\"image\"\r\n                      />\r\n                    );\r\n                  }\r\n                  return (\r\n                    <li\r\n                      className={\r\n                        clicked.chat_uid === chat.chat_uid && \"is-active\"\r\n                          ? \"list-group-item chat-conversation-select chat-is-active\"\r\n                          : \"list-group-item chat-conversation-select\"\r\n                      }\r\n                      key={chat.chat_uid}\r\n                      i={chat.chat_uid}\r\n                      n={chat_name}\r\n                      t={timeMessage.getTime()}\r\n                      u={chat_with_usr}\r\n                      onClick={() => {\r\n                        props.setClicked(chat);\r\n                      }}\r\n                    >\r\n                      <div>\r\n                        <figure className=\"avatar\">{p}</figure>\r\n                      </div>\r\n                      <div className=\"users-list-body\">\r\n                        <div>\r\n                          <h5 className=\"last-message-user\" i={chat.chat_uid}>\r\n                            {chat_name}\r\n                          </h5>\r\n                          <p className=\"last-message-chat\" i={chat.chat_uid}>\r\n                            {chat.last_message_message}\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"users-list-action\">\r\n                          <div\r\n                            className={\r\n                              clicked.chat_uid === chat.chat_uid\r\n                                ? \"new-message-count d-none\"\r\n                                : \"new-message-count \"\r\n                            }\r\n                            i={chat.chat_uid}\r\n                          ></div>\r\n                          <small\r\n                            className=\"text-muted last-message-time\"\r\n                            i={chat.chat_uid}\r\n                          >\r\n                            {timeLabel}\r\n                          </small>\r\n                          <div className=\"action-toggle\">\r\n                            <div className=\"dropdown\">\r\n                              <a data-toggle=\"dropdown\" href=\"#\">\r\n                                <MoreHorizontal />\r\n                              </a>\r\n                              <div className=\"dropdown-menu dropdown-menu-right\">\r\n                                <a href=\"#\" className=\"dropdown-item\">\r\n                                  Open\r\n                                </a>\r\n                                <button\r\n                                  onClick={() => profiledata(chat.chat_uid)}\r\n                                  data-navigation-target=\"contact-information\"\r\n                                  className=\"dropdown-item\"\r\n                                >\r\n                                  Profile\r\n                                </button>\r\n                                <a\r\n                                  href=\"#\"\r\n                                  onClick={() => ArchiveChat(chat.chat_uid)}\r\n                                  className=\"dropdown-item\"\r\n                                >\r\n                                  Add to archive\r\n                                </a>\r\n                                <div className=\"dropdown-divider\"></div>\r\n                                <a\r\n                                  href=\"#\"\r\n                                  onClick={() => DeleteChat(chat.chat_uid)}\r\n                                  className=\"dropdown-item text-danger\"\r\n                                  //   onclick=\"DeleteChat('${\r\n                                  //   chat.chat_uid\r\n                                  // }')\"\r\n                                >\r\n                                  Delete\r\n                                </a>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n                  );\r\n                } else if (chat.chat_type == 1) {\r\n                  if (chat.user_chat == chat.last_message_user_uid) {\r\n                    let chat_name = chat.chat_name;\r\n                    let chat_with_usr = chat.user_chat;\r\n                    let chat_initial = chat_name.substring(0, 1);\r\n                    let timeMessage = new Date(chat.last_message_time);\r\n                    let timeLabel;\r\n                    let today = new Date();\r\n                    let yesterday = new Date();\r\n                    yesterday.setDate(yesterday.getDate() - 1);\r\n                    if (\r\n                      timeMessage.getDate() == today.getDate() &&\r\n                      timeMessage.getMonth() == today.getMonth() &&\r\n                      timeMessage.getFullYear() == today.getFullYear()\r\n                    ) {\r\n                      timeLabel = timeformat(timeMessage);\r\n                    } else if (\r\n                      timeMessage.getDate() == yesterday.getDate() &&\r\n                      timeMessage.getMonth() == yesterday.getMonth() &&\r\n                      timeMessage.getFullYear() == yesterday.getFullYear()\r\n                    ) {\r\n                      timeLabel = \"Ayer\";\r\n                    } else {\r\n                      timeLabel = getDateLabel(timeMessage);\r\n                    }\r\n                    return (\r\n                      <li\r\n                        className=\"list-group-item chat-conversation-select\"\r\n                        key={chat.chat_uid}\r\n                        i={chat.chat_uid}\r\n                        n={chat_name}\r\n                        t={timeMessage.getTime()}\r\n                        u={chat_with_usr}\r\n                        onClick={() => console.log(\"holaaaa\")}\r\n                      >\r\n                        <div>\r\n                          <figure className=\"avatar\">\r\n                            <span className=\"avatar-title bg-info rounded-circle\">\r\n                              {chat_initial}\r\n                            </span>\r\n                          </figure>\r\n                          <div className=\"users-list-body\">\r\n                            <div>\r\n                              <h5\r\n                                className=\"last-message-user\"\r\n                                i={chat.chat_uid}\r\n                              >\r\n                                {chat_name}\r\n                              </h5>\r\n                              <p\r\n                                className=\"last-message-chat\"\r\n                                i={chat.chat_uid}\r\n                              >\r\n                                {chat.name}: {chat.last_message_message}\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"users-list-action\">\r\n                            <div\r\n                              className={\r\n                                clicked.chat_uid === chat.chat_uid\r\n                                  ? \"new-message-count d-none\"\r\n                                  : \"new-message-count\"\r\n                              }\r\n                              i={chat.chat_uid}\r\n                            >\r\n                              <small\r\n                                className=\"text-muted last-message-time\"\r\n                                i={chat.chat_uid}\r\n                              >\r\n                                {timeLabel}\r\n                              </small>\r\n                              <div className=\"action-toggle\">\r\n                                <div className=\"dropdown\">\r\n                                  <a data-toggle=\"dropdown\" href=\"#\">\r\n                                    <MoreHorizontal />\r\n                                  </a>\r\n                                  <div className=\"dropdown-menu dropdown-menu-right\">\r\n                                    <a href=\"#\" className=\"dropdown-item\">\r\n                                      Open\r\n                                    </a>\r\n                                    <button\r\n                                      // onClick={profiledata({chat.chat_uid})}\r\n                                      data-navigation-target=\"contact-information\"\r\n                                      className=\"dropdown-item\"\r\n                                    >\r\n                                      Profile\r\n                                    </button>\r\n                                    <a\r\n                                      href=\"#\"\r\n                                      // onClick=\"ArchiveChat('${chat.chat_uid}')\"\r\n                                      className=\"dropdown-item\"\r\n                                    >\r\n                                      Add to archive\r\n                                    </a>\r\n                                    <div className=\"dropdown-divider\"></div>\r\n                                    <a\r\n                                      href=\"#\"\r\n                                      className=\"dropdown-item text-danger\"\r\n                                    >\r\n                                      Delete\r\n                                    </a>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </li>\r\n                    );\r\n                  }\r\n                }\r\n              }\r\n            })}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatSidebar;\r\n"]},"metadata":{},"sourceType":"module"}