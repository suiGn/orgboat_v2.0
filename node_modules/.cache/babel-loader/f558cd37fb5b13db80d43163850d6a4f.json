{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\kgrob\\\\Documents\\\\Proyectos de programaci\\xF3n\\\\OrgBoat\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\Users\\\\kgrob\\\\Documents\\\\Proyectos de programaci\\xF3n\\\\OrgBoat\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import socketIOClient from\"socket.io-client\";import ChatBodyNoMessage from\"./ChatBodyNoMessage\";import ChatBodyMessage from\"./ChatBodyMessage\";import ChatSideBar from\"./ChatSidebar\";import ReactDOM from\"react-dom\";import $ from\"jquery\";var ENDPOINT=\"http://localhost:5000\";function ChatBody(_ref){var my_uid=_ref.my_uid,clicked=_ref.clicked,setuserProfile=_ref.setuserProfile,newChat=_ref.newChat;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chatMessages=_useState2[0],setChatMessages=_useState2[1];var messagesArray;var currentPage=0;var socket=socketIOClient(ENDPOINT);useEffect(function(){if(clicked!=0){currentPage=currentPage+1;socket.emit(\"get messages\",{id:clicked.chat_uid,page:currentPage});}if(newChat!=0){currentPage=currentPage+1;socket.emit(\"get messages\",{id:newChat.chat_uid,page:currentPage});console.log(\"new\",newChat);}socket.on(\"retrieve messages\",function(response){// setChatMessages((chatMessages) => [...chatMessages, response.messages]);\nsetChatMessages(response.messages);socket.emit(\"get chats\");});},[clicked,newChat]);useEffect(function(){socket.on(\"chat message\",function(response){setChatMessages(function(chatMessages){return[response].concat(_toConsumableArray(chatMessages));});socket.emit(\"get chats\");});},[]);messagesArray=chatMessages;return/*#__PURE__*/React.createElement(\"div\",{className:\"chat\"},messagesArray&&messagesArray.length>0&&clicked.chat_uid||newChat.chat_uid?/*#__PURE__*/React.createElement(ChatBodyMessage,{messages:messagesArray,clicked:clicked,my_uid:my_uid,page:currentPage,setuserProfile:setuserProfile}):/*#__PURE__*/React.createElement(ChatBodyNoMessage,null));}export default ChatBody;","map":{"version":3,"sources":["C:/Users/kgrob/Documents/Proyectos de programaciÃ³n/OrgBoat/src/components/ChatBody.js"],"names":["React","useState","useEffect","socketIOClient","ChatBodyNoMessage","ChatBodyMessage","ChatSideBar","ReactDOM","$","ENDPOINT","ChatBody","my_uid","clicked","setuserProfile","newChat","chatMessages","setChatMessages","messagesArray","currentPage","socket","emit","id","chat_uid","page","console","log","on","response","messages","length"],"mappings":"oYAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,cAAP,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,iBAAP,KAA8B,qBAA9B,CACA,MAAOC,CAAAA,eAAP,KAA4B,mBAA5B,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,QAAP,KAAqB,WAArB,CACA,MAAOC,CAAAA,CAAP,KAAc,QAAd,CACA,GAAMC,CAAAA,QAAQ,CAAG,uBAAjB,CAEA,QAASC,CAAAA,QAAT,MAAgE,IAA5CC,CAAAA,MAA4C,MAA5CA,MAA4C,CAApCC,OAAoC,MAApCA,OAAoC,CAA3BC,cAA2B,MAA3BA,cAA2B,CAAXC,OAAW,MAAXA,OAAW,eACtBb,QAAQ,CAAC,EAAD,CADc,wCACvDc,YADuD,eACzCC,eADyC,eAE9D,GAAIC,CAAAA,aAAJ,CACA,GAAIC,CAAAA,WAAW,CAAG,CAAlB,CACA,GAAMC,CAAAA,MAAM,CAAGhB,cAAc,CAACM,QAAD,CAA7B,CACAP,SAAS,CAAC,UAAM,CACd,GAAIU,OAAO,EAAI,CAAf,CAAkB,CAChBM,WAAW,CAAGA,WAAW,CAAG,CAA5B,CACAC,MAAM,CAACC,IAAP,CAAY,cAAZ,CAA4B,CAAEC,EAAE,CAAET,OAAO,CAACU,QAAd,CAAwBC,IAAI,CAAEL,WAA9B,CAA5B,EACD,CACD,GAAIJ,OAAO,EAAI,CAAf,CAAkB,CAChBI,WAAW,CAAGA,WAAW,CAAG,CAA5B,CACAC,MAAM,CAACC,IAAP,CAAY,cAAZ,CAA4B,CAAEC,EAAE,CAAEP,OAAO,CAACQ,QAAd,CAAwBC,IAAI,CAAEL,WAA9B,CAA5B,EACAM,OAAO,CAACC,GAAR,CAAY,KAAZ,CAAmBX,OAAnB,EACD,CACDK,MAAM,CAACO,EAAP,CAAU,mBAAV,CAA+B,SAACC,QAAD,CAAc,CAC3C;AACAX,eAAe,CAACW,QAAQ,CAACC,QAAV,CAAf,CACAT,MAAM,CAACC,IAAP,CAAY,WAAZ,EACD,CAJD,EAKD,CAfQ,CAeN,CAACR,OAAD,CAAUE,OAAV,CAfM,CAAT,CAiBAZ,SAAS,CAAC,UAAM,CACdiB,MAAM,CAACO,EAAP,CAAU,cAAV,CAA0B,SAACC,QAAD,CAAc,CACtCX,eAAe,CAAC,SAACD,YAAD,SAAmBY,QAAnB,4BAAgCZ,YAAhC,IAAD,CAAf,CACAI,MAAM,CAACC,IAAP,CAAY,WAAZ,EACD,CAHD,EAID,CALQ,CAKN,EALM,CAAT,CAOAH,aAAa,CAAGF,YAAhB,CACA,mBACE,2BAAK,SAAS,CAAC,MAAf,EACIE,aAAa,EAAIA,aAAa,CAACY,MAAd,CAAuB,CAAxC,EAA6CjB,OAAO,CAACU,QAAtD,EACDR,OAAO,CAACQ,QADP,cAEC,oBAAC,eAAD,EACE,QAAQ,CAAEL,aADZ,CAEE,OAAO,CAAEL,OAFX,CAGE,MAAM,CAAED,MAHV,CAIE,IAAI,CAAEO,WAJR,CAKE,cAAc,CAAEL,cALlB,EAFD,cAUC,oBAAC,iBAAD,MAXJ,CADF,CAgBD,CAED,cAAeH,CAAAA,QAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport socketIOClient from \"socket.io-client\";\r\nimport ChatBodyNoMessage from \"./ChatBodyNoMessage\";\r\nimport ChatBodyMessage from \"./ChatBodyMessage\";\r\nimport ChatSideBar from \"./ChatSidebar\";\r\nimport ReactDOM from \"react-dom\";\r\nimport $ from \"jquery\";\r\nconst ENDPOINT = \"http://localhost:5000\";\r\n\r\nfunction ChatBody({ my_uid, clicked, setuserProfile, newChat }) {\r\n  const [chatMessages, setChatMessages] = useState([]);\r\n  let messagesArray;\r\n  let currentPage = 0;\r\n  const socket = socketIOClient(ENDPOINT);\r\n  useEffect(() => {\r\n    if (clicked != 0) {\r\n      currentPage = currentPage + 1;\r\n      socket.emit(\"get messages\", { id: clicked.chat_uid, page: currentPage });\r\n    }\r\n    if (newChat != 0) {\r\n      currentPage = currentPage + 1;\r\n      socket.emit(\"get messages\", { id: newChat.chat_uid, page: currentPage });\r\n      console.log(\"new\", newChat);\r\n    }\r\n    socket.on(\"retrieve messages\", (response) => {\r\n      // setChatMessages((chatMessages) => [...chatMessages, response.messages]);\r\n      setChatMessages(response.messages);\r\n      socket.emit(\"get chats\");\r\n    });\r\n  }, [clicked, newChat]);\r\n\r\n  useEffect(() => {\r\n    socket.on(\"chat message\", (response) => {\r\n      setChatMessages((chatMessages) => [response, ...chatMessages]);\r\n      socket.emit(\"get chats\");\r\n    });\r\n  }, []);\r\n\r\n  messagesArray = chatMessages;\r\n  return (\r\n    <div className=\"chat\">\r\n      {(messagesArray && messagesArray.length > 0 && clicked.chat_uid) ||\r\n      newChat.chat_uid ? (\r\n        <ChatBodyMessage\r\n          messages={messagesArray}\r\n          clicked={clicked}\r\n          my_uid={my_uid}\r\n          page={currentPage}\r\n          setuserProfile={setuserProfile}\r\n        />\r\n      ) : (\r\n        <ChatBodyNoMessage />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatBody;\r\n"]},"metadata":{},"sourceType":"module"}